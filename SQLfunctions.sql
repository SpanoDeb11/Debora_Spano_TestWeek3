--Funzioni
--1. Tabella listino pizze (nome, prezzo) ordinato alfabeticamente (parametri:nessuno)create function PizzeOrdinate()returns tableas	return 	select top(1000) P.*	from Pizza P	order by P.Nomeselect * from PizzeOrdinate();--2. Tabella listino pizze (nome, prezzo) contenenti un ingrediente (parametri: nome ingrediente)create function PizzeConIngrediente(@NomeIngrediente varchar(30))returns tableas	return	select distinct P.*	from Pizza P	join PizzaIngrediente PIN on P.Codice = PIN.CodPizza	join Ingrediente I on I.Codice = PIN.CodIngrediente	where I.Nome = @NomeIngredienteselect * from PizzeConIngrediente('Bresaola');--3. Tabella listino pizze (nome, prezzo) che non contengono un certo ingrediente(parametri: nome ingrediente)create function PizzeSenzaIngrediente(@NomeIngrediente varchar(30))returns tableas	return	select distinct P.*	from Pizza P	join PizzaIngrediente PIN on P.Codice = PIN.CodPizza	join Ingrediente I on I.Codice = PIN.CodIngrediente	where I.Nome <> @NomeIngrediente and 		  P.Nome not in (select P.Nome						 from Pizza P						 join PizzaIngrediente PIN on P.Codice = PIN.CodPizza						 join Ingrediente I on I.Codice = PIN.CodIngrediente						 where I.Nome = @NomeIngrediente)select * from PizzeSenzaIngrediente('Pomodoro');--4. Calcolo numero pizze contenenti un ingrediente (parametri: nome ingrediente)create function NumPizzeConIngrediente(@NomeIngrediente varchar(30))returns intasbegin	declare @NumPizze int	select @NumPizze = count(*)	from PizzeConIngrediente(@NomeIngrediente)	return @NumPizzeendselect dbo.NumPizzeConIngrediente('Pomodoro') as [Numero pizze con ingrediente];--5. Calcolo numero pizze che non contengono un ingrediente (parametri: codice ingrediente)create function NumPizzeSenzaIngrediente(@Codice int)returns intasbegin	declare @NumPizze int	declare @NomeIngrediente varchar(30)	select @NomeIngrediente = I.Nome	from Ingrediente I	where I.Codice = @Codice	select @NumPizze = count(*)	from PizzeSenzaIngrediente(@NomeIngrediente)	return @NumPizzeendselect dbo.NumPizzeSenzaIngrediente(24) as [Numero pizze senza ingrediente];--6. Calcolo numero ingredienti contenuti in una pizza (parametri: nome pizza)create function NumIngredientePerPizza(@NomePizza varchar(30))returns intasbegin	declare @NumIngrediente int	select @NumIngrediente = count(*)	from Ingrediente I	join PizzaIngrediente PIN on I.Codice = PIN.CodIngrediente	join Pizza P on P.Codice = PIN.CodPizza	where P.Nome = @NomePizza	return @NumIngredienteendselect dbo.NumIngredientePerPizza('Quattro stagioni') as [Numero Ingredienti];